

<!doctype html>

<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Дополнительные материалы: &#8212; документация Интеграция Artix-УНФ 0.41</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bizstyle.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/translations.js"></script>
    <script src="_static/bizstyle.js"></script>
    <link rel="index" title="Алфавитный указатель" href="genindex.html" />
    <link rel="search" title="Поиск" href="search.html" />
    <link rel="next" title="Сайт с документацией" href="docs.html" />
    <link rel="prev" title="Добавление группы сертификатов со сроком действия через REST API." href="sert.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Навигация</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Алфавитный указатель"
             accesskey="I">указатель</a></li>
        <li class="right" >
          <a href="docs.html" title="Сайт с документацией"
             accesskey="N">вперёд</a> |</li>
        <li class="right" >
          <a href="sert.html" title="Добавление группы сертификатов со сроком действия через REST API."
             accesskey="P">назад</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">документация Интеграция Artix-УНФ 0.41</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="setting.html" accesskey="U">Настройки</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Дополнительные материалы:</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="id1">
<h1>Дополнительные материалы:<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h1>
<section id="id2">
<h2>1. Список директорий и файлов  основных настроек.<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><dl class="simple">
<dt>/linuxcash/cash/conf/</dt><dd><ol class="arabic simple">
<li><p>ncash.ini - основной файл настроек</p></li>
<li><p>bcode.ini  - правила разбора ШК</p></li>
<li><p>frinit.conf - инициализация ФР</p></li>
<li><p>cliche.txt и tail.txt - Клише/подвал чека</p></li>
<li><p>artixsb.conf</p></li>
</ol>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>/linuxcash/cash/conf/ncash.ini.d/</dt><dd><ol class="arabic simple">
<li><p>artixbonus.ini - работа с бонусным сервером</p></li>
<li><p>artixcertificate.ini</p></li>
<li><p>deferredcheck.ini - отложенные чеки</p></li>
<li><p>fr.ini</p></li>
<li><p>gui.ini - выбор интерфейса ПО</p></li>
<li><p>motp.ini - сигареты</p></li>
<li><p>markedgoods.ini - другая маркировка</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>/linuxcash/cash/conf/drivers/ - Настройки подключения оборудования</p></li>
</ol>
<p>Сначала настраивается одна ПОС, полученные настройки используем как эталонные. После установки ПО на новую ПОС копируем настройки,
включая “Подключаемое оборудование”, проверяем и при необходимости вносим правки.</p>
</section>
<section id="id3">
<h2>2. Особенности настройки “Сбербанк”<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h2>
<p>Для работы с процессингом сбербанк необходимо установить пакет - <em>artix45-plugin-sb</em>.
В директорию <strong>”/linuxcash/cash/paysystems/sb/“</strong> разместить файлы приложения сбербанк полученного от сотрудников банка. Настроить подключение ПинПад согласно инструкции банка (pinpad.ini). Следует обратить внимание что при подключении пинпад через USB, необходимо правильно создать символьную ссылку на устройство:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">serial</span><span class="o">/</span><span class="n">by</span><span class="o">-</span><span class="nb">id</span><span class="o">/</span><span class="p">{</span><span class="n">Имя_Устройства</span><span class="p">}</span> <span class="o">/</span><span class="n">linuxcash</span><span class="o">/</span><span class="n">cash</span><span class="o">/</span><span class="n">paysystems</span><span class="o">/</span><span class="n">sb</span><span class="o">/</span><span class="n">ttyS99</span>
</pre></div>
</div>
<p>Для работы с терминалом PAX SP30 - дополнительно установить пакет <em>ttypos</em></p>
</section>
<section id="yuki">
<h2>3. Ссылка на скачивание дистрибутива yuki<a class="headerlink" href="#yuki" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><p><a class="reference external" href="http://update.artix.su/static/yuki/">http://update.artix.su/static/yuki/</a></p>
</div></blockquote>
</section>
<section id="id4">
<h2>4. Остатки<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h2>
<p>в конфигурационном файле /linuxcash/cash/conf/ncash.ini
Изменить:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">;</span><span class="n">calculateRemainsOfGoods</span> <span class="o">=</span> <span class="n">false</span>
<span class="o">.....</span>
<span class="p">;</span><span class="n">considerRemainsOfGoods</span> <span class="o">=</span> <span class="n">false</span>
</pre></div>
</div>
<p>на:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">calculateRemainsOfGoods</span> <span class="o">=</span> <span class="n">true</span>
<span class="o">.....</span>
<span class="n">considerRemainsOfGoods</span> <span class="o">=</span> <span class="n">true</span>
</pre></div>
</div>
<p>После изменения настроек надо перезапустить кассовое По.
Тогда касса будет считать остатки и учитывать их при продажи</p>
<p>Для товара, у которого не нужно контролировать остатки (кулинария) при выгрузке не указываем дату остатков - <em>remaindate</em>, а поле <em>remain</em>
оставляем <strong>пустым!!!</strong> (не «0»!!!).</p>
</section>
<section id="id5">
<h2>5. Дисконтные карты (создание)<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h2>
<blockquote>
<div><ol class="arabic simple">
<li><p>создать счет на бонусном сервере</p></li>
<li><p>привязать номер карты к счету</p></li>
<li><p>создать карту на кассовом сервере (группа должна быть создана заранее)</p></li>
</ol>
<p>1 и 2 это работа с апи бонусного сервера</p>
<p>3 это работа с файлом аиф, или через рестапи загрузки справочников с Кассовым севером.</p>
<p><a class="reference external" href="https://docs.artix.su/pages/viewpage.action?pageId=27530936">https://docs.artix.su/pages/viewpage.action?pageId=27530936</a></p>
</div></blockquote>
</section>
<section id="id6">
<h2>6. Настройка действий и контекста клавиш<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h2>
<figure class="align-default">
<img alt="_images/key.jpg" src="_images/key.jpg" />
</figure>
</section>
<section id="id7">
<h2>7. Конфигурирование дистконтной системы<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<p>Ссылка на сайт с полной <a class="reference external" href="https://docs.artix.su/pages/viewpage.action?pageId=27531279#id-Встроеннаядисконтнаяподсистема-Конфигурирование">инструкцией</a></p>
<p>Дисконтная система поставляется отдельным пакетом artix45-discountsystem.</p>
<p>Наличие минимальной цены влияет на методы распределения скидок на чек и наборы.
Минимальные цены не учитываются на этапе расчета скидок, дополнительное ограничение минимальной цены накладывается на этапе применения.</p>
<p>Сумма скидки на чек распределяется в два этапа:</p>
<ul class="simple">
<li><p>распределение по позициям пропорционально стоимости каждой позиции,</p></li>
<li><p>размещение остатка максимально возможными суммами начиная с первой позиции.</p></li>
</ul>
<p>Правила распределения остатка определяется параметром <strong>distributeReceiptDiscountFully</strong> в конфигурационном файле <em>/linuxcash/cash/conf/ncash.ini в секции [Discount]:</em></p>
<ul class="simple">
<li><p>при значении параметра true остаток скидки распределяется максимально возможными суммами, учитывая ограничения минимальной ценой товара. Выполняется только первый этап распределения скидки;</p></li>
<li><p>при значении параметра false сумма скидки на чек распределяется по позициям пропорционально их стоимости.</p></li>
</ul>
<p>Размер скидки на позицию ограничивается минимальной ценой товара. В случае предоставления скидок на наборы минимальную цену
на товары можно игнорировать для того, чтобы иметь возможность задавать акции вида «купи две штуки и одну получи в подарок»,
когда скидка назначается только на один из товаров. Возможность игнорирования минимальной цены при предоставлении скидки
на наборы задается параметром <strong>ignoreMinimalPriceForKit</strong> в конфигурационном файле <em>/linuxcash/cash/conf/ncash.ini в секции [Discount]:</em></p>
<ul class="simple">
<li><p>при значении параметра true минимальная цена при применении скидки на набор игнорируется,</p></li>
<li><p>при значении параметра false скидка на комплект будет предоставлена с учетом минимальной цены на товар.</p></li>
</ul>
<p>В основе дисконтной системы заложена идея использования любых доступных элементов чека (товарная позиция, дисконтная карта и т.д.)
для проверки условий и вычисления ставок. Так как условия скидок могут быть сложными, то после изменения состава чека выполняется
отмена ранее примененных скидок, последующий пересчет и применение новых. Пересчет скидок может занимать продолжительное время,
это может происходить из-за недостатка ресурсов машины, на которой осуществляется работа, или из-за сложности самих скидок.
Кассовое ПО Artix может быть настроено таким образом, чтобы расчет скидок происходил как в процессе формирования чека,
так и только при переходе к оплате документа. Момент расчета скидок задается параметром <strong>recalcDiscInFormingMode</strong>
в конфигурационном файле <em>/linuxcash/cash/conf/ncash.ini в секции [Check]:</em></p>
<ul class="simple">
<li><p>при значении параметра true скидки пересчитываются в режиме формирования документа,</p></li>
<li><p>при значении параметра false скидки пересчитываются при переходе в подитог.</p></li>
</ul>
<p>Если расчет скидок происходит в режиме формирования документа, то пересчет скидок выполняется после:</p>
<ul class="simple">
<li><p>добавления или сторнирования товарной позиции,</p></li>
<li><p>добавления или удаления карты,</p></li>
<li><p>изменения модификаторов (цена, количество и т.п.) товарной позиции.</p></li>
</ul>
<p>При использовании акций со ставкой 0% (например, рекламных) можно контролировать запись информации о сработавшем дисконтном
воздействии на позицию в БД <em>Documents</em> таблицу <em>Discitem</em>. Возможность сохранения скидки 0% на позицию
в БД задается параметром <strong>saveNullDiscountForPosition</strong> в конфигурационном файле <em>/linuxcash/cash/conf/ncash.ini в секции [Discount]:</em></p>
<ul class="simple">
<li><p>при значении параметра true скидки 0% на позицию сохраняются в БД,</p></li>
<li><p>при значении параметра false скидки 0% на позицию не сохраняются в БД.</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 17.6%" />
<col style="width: 11.8%" />
<col style="width: 17.6%" />
<col style="width: 35.3%" />
<col style="width: 17.6%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Наименование</p></th>
<th class="head"><p>Тип данных</p></th>
<th class="head"><p>Возможные значения</p></th>
<th class="head"><p>Описание</p></th>
<th class="head"><p>Примечания</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>distributeReceiptDiscountFully</p></td>
<td><p>логический</p></td>
<td><p>true, false</p></td>
<td><p>Полностью распределять по позициям сумму скидки на чек</p></td>
<td><p>По умолчанию true</p></td>
</tr>
<tr class="row-odd"><td><p>ignoreMinimalPriceForKit</p></td>
<td><p>логический</p></td>
<td><p>true, false</p></td>
<td><p>Игнорировать минимальную цену при применении скидки на комплект</p></td>
<td><p>По умолчанию true</p></td>
</tr>
<tr class="row-even"><td><p>recalcDiscInFormingMode</p></td>
<td><p>логический</p></td>
<td><p>true, false</p></td>
<td><p>Пересчитывать скидки в режиме формирования чека</p></td>
<td><p>По умолчанию true</p></td>
</tr>
<tr class="row-odd"><td><p>saveNullDiscountForPosition</p></td>
<td><p>логический</p></td>
<td><p>true, false</p></td>
<td><p>Сохранять скидку 0% на позицию в базу данных</p></td>
<td><p>По умолчанию false</p></td>
</tr>
</tbody>
</table>
<p>S</p>
<p><strong>Пример настроек</strong></p>
<div class="highlight-ini notranslate" id="id9"><div class="highlight"><pre><span></span><span class="k">[Discounts]</span><span class="w"></span>
<span class="c1">;</span><span class="w"></span>
<span class="c1">; Скидки</span><span class="w"></span>
<span class="c1">;</span><span class="w"></span>
<span class="na">...</span><span class="w"></span>
<span class="c1">; Полностью распределять по позициям сумму скидки на чек</span><span class="w"></span>
<span class="na">distributeReceiptDiscountFully</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span><span class="w"></span>
<span class="na">...</span><span class="w"></span>
<span class="c1">; Сохранять скидку 0% на позицию в базу данных</span><span class="w"></span>
<span class="na">saveNullDiscountForPosition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
<span class="c1">; Игнорировать минимальную цену при применении скидки на комплект</span><span class="w"></span>
<span class="na">ignoreMinimalPriceForKit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">false</span><span class="w"></span>

<span class="k">[Check]</span><span class="w"></span>
<span class="c1">;</span><span class="w"></span>
<span class="c1">; Настройки чека</span><span class="w"></span>
<span class="c1">;</span><span class="w"></span>
<span class="na">...</span><span class="w"></span>
<span class="c1">; Пересчитывать скидки в режиме формирования чека, по-умолчанию true.</span><span class="w"></span>
<span class="na">recalcDiscInFormingMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">true</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Оглавление</a></h3>
<p class="caption" role="heading"><span class="caption-text">Содержание:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="description.html">Общее описание</a></li>
<li class="toctree-l1"><a class="reference internal" href="unf.html">Реализация в УНФ</a></li>
<li class="toctree-l1"><a class="reference internal" href="prox.html">Внешняя программма</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="setting.html">Настройки</a></li>
<li class="toctree-l1"><a class="reference internal" href="docs.html">Сайт с документацией</a></li>
<li class="toctree-l1"><a class="reference internal" href="git.html">Установка и настройка Gitea</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">Файлы</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Быстрый поиск</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Искать" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Навигация</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Алфавитный указатель"
             >указатель</a></li>
        <li class="right" >
          <a href="docs.html" title="Сайт с документацией"
             >вперёд</a> |</li>
        <li class="right" >
          <a href="sert.html" title="Добавление группы сертификатов со сроком действия через REST API."
             >назад</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">документация Интеграция Artix-УНФ 0.41</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="setting.html" >Настройки</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Дополнительные материалы:</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2023, PashkovKV.
    </div>
  </body>
</html>