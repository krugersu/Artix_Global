Дополнительные материалы:
-------------------------

1. Список директорий и файлов  основных настроек.
"""""""""""""""""""""""""""""""""""""""""""""""""

#. /linuxcash/cash/conf/
	#) ncash.ini - основной файл настроек
	#) bcode.ini  - правила разбора ШК
	#) frinit.conf - инициализация ФР
	#) cliche.txt и tail.txt - Клише/подвал чека
	#) artixsb.conf

#. /linuxcash/cash/conf/ncash.ini.d/
	#) artixbonus.ini - работа с бонусным сервером
	#) artixcertificate.ini
	#) deferredcheck.ini - отложенные чеки
	#) fr.ini
	#) gui.ini - выбор интерфейса ПО
	#) motp.ini - сигареты
	#) markedgoods.ini - другая маркировка
	   
#. /linuxcash/cash/conf/drivers/ - Настройки подключения оборудования


Сначала настраивается одна ПОС, полученные настройки используем как эталонные. После установки ПО на новую ПОС копируем настройки,
включая “Подключаемое оборудование”, проверяем и при необходимости вносим правки.


2. Особенности настройки “Сбербанк”	   
"""""""""""""""""""""""""""""""""""

Для работы с процессингом сбербанк необходимо установить пакет - *artix45-plugin-sb*.
В директорию **”/linuxcash/cash/paysystems/sb/“** разместить файлы приложения сбербанк полученного от сотрудников банка. Настроить подключение ПинПад согласно инструкции банка (pinpad.ini). Следует обратить внимание что при подключении пинпад через USB, необходимо правильно создать символьную ссылку на устройство:

::

	ln -s /dev/serial/by-id/{Имя_Устройства} /linuxcash/cash/paysystems/sb/ttyS99

Для работы с терминалом PAX SP30 - дополнительно установить пакет *ttypos*


3. Ссылка на скачивание дистрибутива yuki
"""""""""""""""""""""""""""""""""""""""""	
	http://update.artix.su/static/yuki/ 
	

4. Остатки
""""""""""

в конфигурационном файле /linuxcash/cash/conf/ncash.ini
Изменить:

::

	;calculateRemainsOfGoods = false
	.....
	;considerRemainsOfGoods = false

на:


::

	calculateRemainsOfGoods = true
	.....
	considerRemainsOfGoods = true


После изменения настроек надо перезапустить кассовое По.
Тогда касса будет считать остатки и учитывать их при продажи

Для товара, у которого не нужно контролировать остатки (кулинария) при выгрузке не указываем дату остатков - *remaindate*, а поле *remain* 
оставляем **пустым!!!** (не "0"!!!).


5. Дисконтные карты (создание)
""""""""""""""""""""""""""""""

	1. создать счет на бонусном сервере
	2. привязать номер карты к счету
	3. создать карту на кассовом сервере (группа должна быть создана заранее)

	1 и 2 это работа с апи бонусного сервера

	3 это работа с файлом аиф, или через рестапи загрузки справочников с Кассовым севером.

	https://docs.artix.su/pages/viewpage.action?pageId=27530936


6. Настройка действий и контекста клавиш
""""""""""""""""""""""""""""""""""""""""

.. figure:: images/key.jpg




7. Конфигурирование дистконтной системы
""""""""""""""""""""""""""""""""""""""""	

Ссылка на сайт с полной инструкцией_

.. _инструкцией: https://docs.artix.su/pages/viewpage.action?pageId=27531279#id-Встроеннаядисконтнаяподсистема-Конфигурирование


Дисконтная система поставляется отдельным пакетом artix45-discountsystem.

Наличие минимальной цены влияет на методы распределения скидок на чек и наборы.
Минимальные цены не учитываются на этапе расчета скидок, дополнительное ограничение минимальной цены накладывается на этапе применения. 


Сумма скидки на чек распределяется в два этапа:

* распределение по позициям пропорционально стоимости каждой позиции,
* размещение остатка максимально возможными суммами начиная с первой позиции.

Правила распределения остатка определяется параметром **distributeReceiptDiscountFully** в конфигурационном файле */linuxcash/cash/conf/ncash.ini в секции [Discount]:*

* при значении параметра true остаток скидки распределяется максимально возможными суммами, учитывая ограничения минимальной ценой товара. Выполняется только первый этап распределения скидки;
* при значении параметра false сумма скидки на чек распределяется по позициям пропорционально их стоимости.

Размер скидки на позицию ограничивается минимальной ценой товара. В случае предоставления скидок на наборы минимальную цену
на товары можно игнорировать для того, чтобы иметь возможность задавать акции вида "купи две штуки и одну получи в подарок",
когда скидка назначается только на один из товаров. Возможность игнорирования минимальной цены при предоставлении скидки
на наборы задается параметром **ignoreMinimalPriceForKit** в конфигурационном файле */linuxcash/cash/conf/ncash.ini в секции [Discount]:*

* при значении параметра true минимальная цена при применении скидки на набор игнорируется,
* при значении параметра false скидка на комплект будет предоставлена с учетом минимальной цены на товар.

В основе дисконтной системы заложена идея использования любых доступных элементов чека (товарная позиция, дисконтная карта и т.д.)
для проверки условий и вычисления ставок. Так как условия скидок могут быть сложными, то после изменения состава чека выполняется
отмена ранее примененных скидок, последующий пересчет и применение новых. Пересчет скидок может занимать продолжительное время,
это может происходить из-за недостатка ресурсов машины, на которой осуществляется работа, или из-за сложности самих скидок.
Кассовое ПО Artix может быть настроено таким образом, чтобы расчет скидок происходил как в процессе формирования чека,
так и только при переходе к оплате документа. Момент расчета скидок задается параметром **recalcDiscInFormingMode**
в конфигурационном файле */linuxcash/cash/conf/ncash.ini в секции [Check]:*

* при значении параметра true скидки пересчитываются в режиме формирования документа,
* при значении параметра false скидки пересчитываются при переходе в подитог.

Если расчет скидок происходит в режиме формирования документа, то пересчет скидок выполняется после:

* добавления или сторнирования товарной позиции,
* добавления или удаления карты,
* изменения модификаторов (цена, количество и т.п.) товарной позиции.

При использовании акций со ставкой 0% (например, рекламных) можно контролировать запись информации о сработавшем дисконтном
воздействии на позицию в БД *Documents* таблицу *Discitem*. Возможность сохранения скидки 0% на позицию
в БД задается параметром **saveNullDiscountForPosition** в конфигурационном файле */linuxcash/cash/conf/ncash.ini в секции [Discount]:*

* при значении параметра true скидки 0% на позицию сохраняются в БД,
* при значении параметра false скидки 0% на позицию не сохраняются в БД.

.. atention:: 
	Скидка 0% на чек в БД не записывается.
	Скидка более 0% на позицию, но с результатом 0 р. будет записана в БД.
	Например, если скидка 50%, то для позиций с ценой 0.00 или 0.01 в БД будет записываться информация о скидке.


.. csv-table:: 
    :header: "Наименование",  "Тип данных", "Возможные значения", "Описание", "Примечания"
    :widths: 15,10,15,30,15

    "distributeReceiptDiscountFully", "логический", "true, false","Полностью распределять по позициям сумму скидки на чек", "По умолчанию true"  
    "ignoreMinimalPriceForKit", "логический", "true, false","Игнорировать минимальную цену при применении скидки на комплект", "По умолчанию true" 
    "recalcDiscInFormingMode", "логический", "true, false","Пересчитывать скидки в режиме формирования чека", "По умолчанию true" 
    "saveNullDiscountForPosition", "логический", "true, false","Сохранять скидку 0% на позицию в базу данных", "По умолчанию false" 
    
S

**Пример настроек**

.. code-block:: ini
	:name: Пример настроек	
    
	[Discounts]
	;
	; Скидки
	;
	...
	; Полностью распределять по позициям сумму скидки на чек
	distributeReceiptDiscountFully = false
	...
	; Сохранять скидку 0% на позицию в базу данных
	saveNullDiscountForPosition = true
	; Игнорировать минимальную цену при применении скидки на комплект
	ignoreMinimalPriceForKit = false
	
	[Check]
	;
	; Настройки чека
	;
	...
	; Пересчитывать скидки в режиме формирования чека, по-умолчанию true.
	recalcDiscInFormingMode = true